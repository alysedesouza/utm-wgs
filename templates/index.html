<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Web Page</title>
    <!-- Include Leaflet CSS and JavaScript -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""></script>
</head>
<body>
    <!-- Your HTML content here -->

    <div>
        <label for="zone">Zone:</label>
        <select id="zone">
            <option value="1">1</option>
            <option value="2">2</option>
            <!-- Add more options if needed -->
        </select>
    </div>
    <div>
        <label for="Easting">Easting:</label>
        <input type="text" id="Easting">
    </div>
    <div>
        <label for="Northing">Northing:</label>
        <input type="text" id="Northing">
    </div>
    <button onclick="showSelectedNumbers()">Submit</button>
    <div id="resultSection" style="display: none;">
        <p id="result"></p>
    </div>

    <!-- JavaScript code -->
    <script>
        function showSelectedNumbers() {
            var zoneElement = document.getElementById("zone");
            var selectedZone = zoneElement.value;
            var EastingInput = document.getElementById("Easting");
            var Easting = EastingInput.value.trim();
            var NorthingInput = document.getElementById("Northing");
            var Northing = NorthingInput.value.trim();

            // Validate input values
            if (!Easting || !Northing || isNaN(Easting) || isNaN(Northing)) {
                console.error('Invalid Easting or Northing value');
                alert('Please enter valid Easting and Northing values.');
                return;
            }

            console.log(`Sending data: Zone=${selectedZone}, Easting=${Easting}, Northing=${Northing}`);

            fetch('/convert_coordinates', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    zone: selectedZone,
                    eastings: Easting,
                    northings: Northing
                }),
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                console.log('Received data:', data);
                var resultSection = document.getElementById("resultSection");
                var resultParagraph = document.getElementById("result");
                resultParagraph.textContent = `Transformed Longitude: ${data.transformed_easting}, Transformed Latitude: ${data.transformed_northing}`;
                resultSection.style.display = "block";

                // Add marker to the map
                const marker = L.marker([data.transformed_northing, data.transformed_easting]).addTo(map);
                marker.bindPopup(`Transformed Coordinates:
Longitude: ${data.transformed_easting}
Latitude: ${data.transformed_northing}`).openPopup();

                // Center map on new coordinates
                map.setView([data.transformed_northing, data.transformed_easting], 15);
            })
            .catch((error) => {
                console.error('Error:', error);
                alert('An error occurred while converting coordinates. Please try again.');
            });
        }
    </script>
</body>
</html>
